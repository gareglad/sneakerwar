<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sneaker Rush - Game</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link href="style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="sneakers.js"></script>

    <script type="text/javascript" src="script.js"></script>
    
    <script src="articulate.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-analytics.js";
        import { getFirestore, collection, getDocs, getDoc, addDoc, doc, updateDoc, setDoc, query, where } from 'https://www.gstatic.com/firebasejs/10.12.1/firebase-firestore.js';
        import { getDatabase, set, ref } from 'https://www.gstatic.com/firebasejs/10.12.1/firebase-database.js';
        // import { ref as sRef } from 'https://www.gstatic.com/firebasejs/10.12.1/firebase-storage.js';


        
        const firebaseConfig = {
        apiKey: "AIzaSyAuylrni9nvb7VO_1BfHrX-8KxVH8hNUL8",
        authDomain: "sneaker-war.firebaseapp.com",
        projectId: "sneaker-war",
        storageBucket: "sneaker-war.appspot.com",
        messagingSenderId: "781026399388",
        appId: "1:781026399388:web:7ecc86059c852f69464959",
        measurementId: "G-VB4TW9V7PR"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        const db = getFirestore(app);

        var params = new window.URLSearchParams(window.location.search);
        //console.log(params.get('password'));

        let password = params.get('password');

        const q3 = query(collection(db, "admin"), where('livegame_password', '==' ,password) );
        const querySnapshot3 = await getDocs(q3);

        let game_admin = false;
        let auto_live_game = false;
        let resumed = false;
        if(querySnapshot3.docs[0]){
            game_admin = true;
            auto_live_game = true;
            //setTimeout(auto_click_start,10000);
            setTimeout(function(){
                if($('.boombox-button').hasClass('boombox-button-playing')){
                    //$('.boombox-button').trigger('click');
                }
            },2000);
        }

        function auto_click_start(){
            if(!resumed){
                $('.start-game').trigger('click');
                setTimeout(function(){
                    $('.player1').trigger('click');
                },5000);
            }

        }
            
        $(document).ready(function () {

            let ip_id = '';
            function get_ip(){
                let email = localStorage.getItem('email');
                ip_id = email;
                if(!email){
                    let docRef = ''; 
                    async function addrow(db) {
                    let data = {
                        password: '12345'
                    };
                        docRef = await addDoc(collection(db, "users"), data);
                        localStorage.setItem('email', docRef.id);
                        ip_id = docRef.id;

                        getrow(db,ip_id);

                        console.log(docRef.id);

                    }
                    addrow(db,ip_id); 
                }else{
                    getrow(db,ip_id);
                }

                async function getrow(db,ip_id) {
                  const docRef = doc(db, "users", ip_id);
                  const docSnap  = await getDoc(docRef);
    
                  let points = 0;
                  if (docSnap.exists() && docSnap.data().points) {
                    //console.log("Document data:", docSnap.data());
                    console.log(docSnap.data().points);
    
                    points = docSnap.data().points;    
    
                  } else {
                    console.log("No such document!");
                    async function addrow2(db) {
                        let data = {
                            points: 0
                        };
                        const docRef = await updateDoc(doc(db, "users", ip_id ), data);
                    }
                    addrow2(db);   
                  }

                  $('.point-amount').text(points);
                } 
                
            }
            get_ip();

            function add_points(points_won){
                let ip_id = localStorage.getItem('email',);

                async function getrow2(db) {
                  const docRef = doc(db, "users", ip_id);
                  const docSnap  = await getDoc(docRef);
                  if (docSnap.exists() && docSnap.data().points) {
                    //console.log("Document data:", docSnap.data());
                    console.log(docSnap.data().points);
    
                    let old_points = docSnap.data().points;
                    let new_points = parseInt(old_points) + parseInt(points_won);
    
                    async function setrow(db) {
                        let data = {
                            points: new_points
                        };
                        const docRef = await updateDoc(doc(db, "users", ip_id ), data);
                    }
                    setrow(db);
                    $('.point-amount').text(new_points);

    
    
                  } else {
                    console.log("No such document!");
                    async function addrow3(db) {
                        let data = {
                            points: 50
                        };
                        const docRef = await updateDoc(doc(db, "users", ip_id), data);
                    }
                    addrow3(db);  
                    $('.point-amount').text(50); 
                  }
                }
                getrow2(db); 
                
            }

            function drawCard() {
                let cards_length = cards.length;
                if(game_admin){
                    cards_length = 33;
                }
                var ran = Math.floor(Math.random() * cards_length);
                if(ran == 0){
                    ran = 1;
                }



                const card = cards[ran];
                console.log(card);
                return card;
            }

            function playRound() {
                const player1Card = drawCard();
                const player2Card = drawCard();
                console.log(player1Card);

                localStorage.setItem('player1',player1Card.name);
                localStorage.setItem('player2',player2Card.name);
                

                $('.player1 .name').text(player1Card.name);
                $('.player2 .name').text(player2Card.name);

                $('.team1 .name').text(player1Card.name);
                $('.team2 .name').text(player2Card.name);

            }
            
            let playing = 2;
            let winning_score = 21;
            let auto_game = false;
            let fouled = false;
            let rebound = 0;
            let already_picked = false;
            let game_clock_interval = '';
            let clock_interval = '';
            let game_over = false;
            let next_ball_interval = '';
            let add_score_interval = '';
            let winner_name = '';

            function add_score(){

                let ran2 = Math.floor(Math.random() * 4);
                if(ran2 == 1){
                    ran2 = 0;
                }
                console.log(ran2);
                if(ran2 > 0){
                    //let player_name = $('.player'+playing).text();
                    //var msg = new SpeechSynthesisUtterance(player_name+' Scored a '+ ran2);
                    //window.speechSynthesis.speak(msg);
                
                   // $('.player'+playing+' .name').articulate('speak');
                    setTimeout(function(){
                        //$('.scored.score'+playing).articulate('speak');
                    },2000);


                }
                let old_score = $('.score'+playing).text();
                let new_score = parseInt(old_score) + ran2;
                
                //winning_score = 1;

                
                let game_clock1 = localStorage.getItem('game_clock');
                let timer = '20:00';
                let minutes = '20';
                let seconds = '00';


                if(game_clock1){
                    let timer = game_clock1.split(':');
                    //by parsing integer, I avoid all extra string processing
                    minutes = parseInt(timer[0], 10);
                    seconds = parseInt(timer[1], 10);
                }


                if (Math.random() > 0.73) {
                    clearInterval(clock_interval);
                    clearInterval(game_clock_interval);
                    fouled = true;
                    $('.playing').addClass('foul');

                    let ran5 = Math.floor(Math.random() * 3);

                    if(ran2 > 0){
                        ran5 = Math.floor(Math.random() * 2);
                    }

                     // 20% chance to double the score increment
                    
                    setTimeout(function(){
                        new_score = new_score + ran5;
                        $('.score'+playing).text(new_score);

                        $('.score'+playing+'-scored').text(ran5);

                        setTimeout(function(){
                            $('.scored').text('');
                            $('.foul').removeClass('foul');
                            fouled = false;
                            

                        },1900);
                        
                    },2000);

                    if( (ran2 + new_score) > 0){
                        rebound = 0;
                    }else{
                        ran6 = Math.floor(Math.random() * 2);
                        rebound = ran6;
                    }

                    //if(minutes == 0 && seconds == 0){
                    if(game_over){
                        
                    }else{
                        setTimeout(function(){
                            if(!game_over){
                                clock_interval = setInterval(clock,1000);
                                next_ball();
                                game_clock();
                            }
                        },4000);
                    }
                    
                }

                $('.playing').removeClass('playing');
                $('.score'+playing).text(new_score);

                $('.score'+playing+'-scored').text(ran2);
               
                $('.start-game').text('14');

                if(game_admin){
                    add_live_score();
                }


                //if(new_score >= winning_score){


                let winner = 0;

                    if(!fouled){
                        clearInterval(clock_interval);
                        setTimeout(function(){
                            if(!game_over){
                                $('.scored').text('');
                                clock_interval = setInterval(clock,1000);
                                next_ball();
                            }
                        },2000);
                        
                    }    
                

            }

            function add_live_score(){
                let game_id = localStorage.getItem('game_id');

                let player_1_score = $('.player1 .score').text();
                let player_2_score = $('.player2 .score').text();

                async function setrow2(db) {
                    let data = {
                        score1: player_1_score,
                        score2: player_2_score
                    };
                    const docRef = await updateDoc(doc(db, "games", game_id ), data);
                }
                setrow2(db);
            }

            function game_over_func(){
                let winner = 0;
                    clearInterval(clock_interval);
                    clearInterval(game_clock_interval);
                    $('.start-game').text('14');
                    $('.countdown').text('20:00');
                    
                    let player_score = $('.player'+playing+' .score').text();
                    localStorage.setItem('player'+playing+'_score',player_score);

                    $('.rematch-game').show();

                    let player__1_score = localStorage.getItem('player1_score');
                    let player__2_score = localStorage.getItem('player2_score');

                    if(player__1_score > player__2_score){
                        winner = 1;
                        let player1_name = localStorage.getItem('player1');
                        $('.alert-winner').show().text(player1_name+' Is The Winner!');
                        winner_name = player1_name;
                    }

                    if(player__2_score > player__1_score){
                        winner = 2;
                        let player2_name = localStorage.getItem('player2');
                        $('.alert-winner').show().text(player2_name+' Is The Winner!');
                        winner_name = player2_name;
                    }

                    $('.start-game').text('New Game').addClass('new-game');

                    let picked = $('.player'+winner).hasClass('picked');
                    if(picked){
                        let points_won = 500;

                        // if(winning_score == 1){
                        //     points_won = 500;
                        // }

                        // if(winning_score == 21){
                        //     points_won = 100;
                        // }

                        // if(winning_score == 1){
                        //     points_won = 500;
                        // }

                        add_points(points_won);
                    }else{
                        //add_points(-50);
                    }
                    
                    if(auto_game){
                        setTimeout(auto_game_start,120000);
                        //$('.start-game').text('120');
                        clock_interval = setInterval(clock,1000);
                    }

                    if(auto_live_game){
                        //clearInterval(clock_interval);


                        
                        //$('.start-game').text('120');
                        //clock_interval = setInterval(clock,1000);

   
                        let game_id = localStorage.getItem('game_id');
                        async function setrow3(db) {
                            let data = {
                                winner: winner,
                            };
                            const docRef2 = await updateDoc(doc(db, "games", game_id ), data);
                        }
                        setrow3(db);
                        
                        
                        setTimeout(auto_live_game_start,25000);
                        
                        setTimeout(function(){
                            //location.reload();
                        },20000);

                        if(game_admin){
                            function pay_bets(){
                                async function getrow4(db) {
                                    const q = query(collection(db, "bets"), where('paid', '==', 0) );
                                    const querySnapshot = await getDocs(q);
                                    
                                    //let winner = 2;
                                    querySnapshot.forEach((doc1) => {
                                        console.log(doc1.data().player_picked);
                                        if(doc1.data().player_picked == $('.player'+winner+ ' .name').text()){
                                            console.log($('.player'+winner+' .name').text());
                                            async function getrow3(db,doc1) {
                                              //let user_id = localStorage.getItem('email');
                                                
                                                let user_id = doc1.data().user;
                                                const docRef3 = doc(db, "users", user_id);
                                                const docSnap3  = await getDoc(docRef3);

                                                let old_points = docSnap3.data().points;
                                                let new_points = parseInt(old_points) + 500;

                                                //$('.point-amount').text(new_points);

                                                async function setrow5(db) {
                                                    let data = {
                                                        points: new_points
                                                    };
                                                    const docRef5 = await updateDoc(doc(db, "users", user_id ), data);
                                                }
                                                setrow5(db);
                                                console.log(doc1.id);
                                                async function setrow2(db) {
                                                    let data = {
                                                        paid: 1
                                                    };
                                                    const docRef6 = await updateDoc(doc(db, "bets", doc1.id ), data);
                                                }
                                                setrow2(db);
                                            }                                    
                                            getrow3(db,doc1);
                                        }

                                    });
                                }
                                getrow4(db);
                            }
                            pay_bets();

                            function playoffs(){
                                async function addrow5(db) {
                                    let data = {
                                        'team1': localStorage.getItem('player1'),
                                        'team2': localStorage.getItem('player2'),
                                        'winner': winner_name
                                    };
                                    let docRef = await addDoc(collection(db, "playoffs"), data);
                                    //localStorage.setItem('game_id', docRef.id);
                                    console.log(docRef.id);
                                }
                                addrow5(db); 

                                // async function setrow5(db) {

                                //     const docRef3 = doc(db, "playoffs", winner_name);
                                //     const docSnap3  = await getDoc(docRef3);

                                //     let old_points = docSnap3.data().wins;
                                //     if(!old_points){
                                //         old_points = 0;
                                //     }
                                //     let new_points = parseInt(old_points) + 1;

                                //     let data = {
                                //         points: new_points
                                //     };
                                //     const docRef5 = await updateDoc(doc(db, "playoffs", winner_name ), data);
                                // }
                            }
                            playoffs();
                        }
                    }
            }

            function next_ball(){
                
                let player_score = $('.player'+playing+' .score').text();
                localStorage.setItem('player'+playing+'_score',player_score);


                let game_clock1 = localStorage.getItem('game_clock');
                let timer = '20:00';
                let minutes = '20';
                let seconds = '00';


                if(game_clock1){
                    let timer = game_clock1.split(':');
                    //by parsing integer, I avoid all extra string processing
                    minutes = parseInt(timer[0], 10);
                    seconds = parseInt(timer[1], 10);
                }

                //if(minutes == 0 && seconds == 0){
                if(game_over){
                    
                }else{
                    //let ran8 = Math.floor(Math.random() * (14000 - 2000 + 1)) + 2000;
                    let ran3 = Math.floor(Math.random() * 12000) + 2000;

                    if(rebound == 0){
                        if(playing == 2){
                            playing = 1;
                        }else{
                            playing = 2;
                        }
                    }else{
                        playing = playing;
                    }

                    $('.player'+playing + ' .name').addClass('playing');
                    console.log(ran3);
                    setTimeout(add_score,ran3);
                }


            }


            let player_picked = localStorage.getItem('player_picked');

            let game_win_score = localStorage.getItem('game_win_score');
            if(game_win_score){
                winning_score = game_win_score;
            }

            let player1 = localStorage.getItem('player1');
            let player1_score = localStorage.getItem('player1_score');
            
            let player2 = localStorage.getItem('player2');
            let player2_score = localStorage.getItem('player2_score');

            let clock5 = localStorage.getItem('game_clock');
            let timer5 = '20:00';
            let minutes5 = 20;
            let seconds5 = 0;


            if(clock5){
                timer5 = clock5.split(':');
                //by parsing integer, I avoid all extra string processing
                minutes5 = parseInt(timer5[0], 10);
                seconds5 = parseInt(timer5[1], 10);
            }

            if(player1){
                $('.resume-game').show();
                if(parseInt(player1_score) > parseInt(player2_score) && minutes5 == 0 && seconds5 == 0){
                    $('.resume-game').hide();
                    $('.rematch-game').show();
                    $('.alert-winner').show().text(player1+' Is The Winner!');
                }
                $('.player1 .name').text(player1);
                $('.team1 .name').text(player1);
                if(player_picked == player1){
                    $('.player1').addClass('picked');
                }
                $('.player1 .score').text(player1_score);
            }


            if(player2){
                if(parseInt(player2_score) > parseInt(player1_score) && minutes5 == 0 && seconds5 == 0){
                    $('.resume-game').hide();
                    $('.rematch-game').show();
                    $('.alert-winner').show().text(player2+' Is The Winner!');
                }
                $('.player2 .name').text(player2);
                $('.team2 .name').text(player2);
                
                if(player_picked == player2){
                    $('.player2').addClass('picked');
                }
                $('.player2 .score').text(player2_score);
            }



            function start_game(){

                let game_win_score = winning_score;
                localStorage.setItem('game_win_score',game_win_score);

                let player1 = localStorage.getItem('player1');
                let player2 = localStorage.getItem('player2');

                localStorage.setItem('player1',player1);
                localStorage.setItem('player2',player2);

                let player1_score = $('.player1 .score').text();
                let player2_score = $('.player2 .score').text();

                localStorage.setItem('player1_score',player1_score);
                localStorage.setItem('player2_score',player2_score);

                if(game_admin && player1_score == 0){
                    function live_game_admin(){
                        async function addrow_game(db) {
                        let data = {
                            team1: player1,
                            team2: player2,
                            score1: player1_score,
                            score2: player2_score,
                            winner: 0,
                            time: Date.now()
                        };
                            let docRef = await addDoc(collection(db, "games"), data);
                            localStorage.setItem('game_id', docRef.id);
                            console.log(docRef.id);
                        }
                        addrow_game(db); 
                    }
                    live_game_admin();
                }
                

                if(auto_live_game){
                    //winning_score = 100;
                    //clearInterval(clock_interval);
                }

                let ran5 = Math.floor(Math.random() * 2);
                console.log(ran5);
                if(ran5 == 0){
                    ran5 = 2;
                }else{
                    ran5 = 1;
                }
                playing = ran5;

                $('.player'+playing + ' .name').addClass('playing');

                clearInterval(clock_interval);
                $('.start-game').text('14');
                clock_interval = setInterval(clock,1000);

                if(player1_score == 0){
                    add_points(-50);
                    $('.countdown').text('20:00');
                }
                
                //let ran9 = Math.floor(Math.random() * (14000 - 2000 + 1)) + 2000;

                let ran1 = Math.floor(Math.random() * 12000) + 2000;
                console.log(ran1);

                
                game_clock();
                setTimeout(add_score,ran1);
            }  

            function auto_game_start(){
                setTimeout(function(){
                    $('.new-game').trigger('click');
                }, 4000);
                $('.rematch-game').hide();
                let ran6 = Math.floor(Math.random() * 2);
                console.log(ran6);
                if(ran6 == 0){
                    ran6 = 2;
                }else{
                    ran6 = 1;
                }
                $('.player'+ran6).trigger('click');
            }

            function auto_live_game_start(){

                setTimeout(function(){
                    $('.start-game').trigger('click');
                }, 4000);

                winning_score = 100;

                let ran9 = Math.floor(Math.random() * 2);
                if(ran9 == 0){
                    ran9 = 1;
                }else{
                    ran9 = 2;
                }
                setTimeout(function(){
                    $('.player'+ran9).trigger('click');
                },8000);
            }

            function clock(){
            if(!game_over){
                let clock = $('.start-game').text();
                if($.isNumeric(parseInt(clock))){
                    let new_clock = parseInt(clock) - 1;
                    $('.start-game').text(new_clock);
                }
            }
            }

            let clock3 = localStorage.getItem('game_clock');
            if(clock3){
                $('.countdown').text(clock3);
            }

            function game_clock(){
                game_clock_interval = setInterval(countdown, 1000);            
            }
            function countdown(){

                let clock2 = localStorage.getItem('game_clock');

                if(clock2){
                    var timer2 = clock2;
                }else{
                    var timer2 = "20:00";
                }

                var timer = timer2.split(':');
                //by parsing integer, I avoid all extra string processing
                var minutes = parseInt(timer[0], 10);
                var seconds = parseInt(timer[1], 10);
                --seconds;
                minutes = (seconds < 0) ? --minutes : minutes;
                if ( (minutes == 0 && seconds == 0 ) ){
                    
                    clearInterval(game_clock_interval);
                    game_over = true;
                    game_over_func();
                }
                //if (seconds <= 0) clearInterval(game_clock_interval);
                seconds = (seconds < 0) ? 59 : seconds;
                seconds = (seconds < 10) ? '0' + seconds : seconds;
                //minutes = (minutes < 10) ?  minutes : minutes;
                $('.countdown').html(minutes + ':' + seconds);
                timer2 = minutes + ':' + seconds;

                localStorage.setItem('game_clock', timer2);

                if(game_admin){
                    //add_quarters();
                }

                add_quarters();
            }
            //game_clock();





            let q1t1 = (localStorage.getItem('q1t1') )? localStorage.getItem('q1t1') :'-' ;
            $('.games-table .team1 td:eq(1)').text(q1t1);
            let q1t2 = (localStorage.getItem('q1t2') )? localStorage.getItem('q1t2') :'-' ;
            $('.games-table .team2 td:eq(1)').text(q1t2);
            let q2t1 = (localStorage.getItem('q2t1') )? localStorage.getItem('q2t1') :'-' ;
            $('.games-table .team1 td:eq(2)').text(q2t1);
            let q2t2 = (localStorage.getItem('q2t2') )? localStorage.getItem('q2t2') :'-' ;
            $('.games-table .team2 td:eq(2)').text(q2t2);
            let q3t1 = (localStorage.getItem('q3t1') )? localStorage.getItem('q3t1') :'-' ;
            $('.games-table .team1 td:eq(3)').text(q3t1);
            let q3t2 = (localStorage.getItem('q3t2') )? localStorage.getItem('q3t2') :'-' ;
            $('.games-table .team2 td:eq(3)').text(q3t2);
            let q4t1 = (localStorage.getItem('q4t1') )? localStorage.getItem('q4t1') :'-' ;
            $('.games-table .team1 td:eq(4)').text(q4t1);
            let q4t2 = (localStorage.getItem('q4t2') )? localStorage.getItem('q4t2') :'-' ;
            $('.games-table .team2 td:eq(4)').text(q4t2);

            function add_quarters(){
                let clock4 = localStorage.getItem('game_clock');
                let timer = clock4.split(':');

                let minutes = parseInt(timer[0], 10);
                let seconds = parseInt(timer[1], 10);

                let player1_score_update = localStorage.getItem('player1_score');
                let player2_score_update = localStorage.getItem('player2_score');

                let data = {};
                let update_qt = false;
                if(minutes == 15 && seconds == 0){
                    data = {
                        q1t1: player1_score_update,
                        q1t2: player2_score_update
                    };
                    if(game_admin){
                        update_qt = true;
                    }
                    localStorage.setItem('q1t1',player1_score_update);
                    localStorage.setItem('q1t2',player2_score_update);

                    $('.team1 td:eq(1)').text(player1_score_update);
                    $('.team2 td:eq(1)').text(player2_score_update);
                }
                if(minutes == 10 && seconds == 0){
                    data = {
                        q2t1: player1_score_update,
                        q2t2: player2_score_update
                    };
                    if(game_admin){
                        update_qt = true;
                    }
                    localStorage.setItem('q2t1',player1_score_update);
                    localStorage.setItem('q2t2',player2_score_update);
                    
                    $('.team1 td:eq(2)').text(player1_score_update);
                    $('.team2 td:eq(2)').text(player2_score_update);
                }
                if(minutes == 5 && seconds == 0){
                    data = {
                        q3t1: player1_score_update,
                        q3t2: player2_score_update
                    };
                    if(game_admin){
                        update_qt = true;
                    }
                    localStorage.setItem('q3t1',player1_score_update);
                    localStorage.setItem('q3t2',player2_score_update);

                    $('.team1 td:eq(3)').text(player1_score_update);
                    $('.team2 td:eq(3)').text(player2_score_update);
                }
                if(minutes == 0 && seconds == 0){
                    data = {
                        q4t1: player1_score_update,
                        q4t2: player2_score_update
                    };
                    if(game_admin){
                        update_qt = true;
                    }
                    localStorage.setItem('q4t1',player1_score_update);
                    localStorage.setItem('q4t2',player2_score_update);

                    $('.team1 td:eq(4)').text(player1_score_update);
                    $('.team2 td:eq(4)').text(player2_score_update);
                }

                let game_id = localStorage.getItem('game_id');
                if(update_qt){
                    async function setrow2(db,data) {
                        const docRef = await updateDoc(doc(db, "games", game_id ), data);
                    }
                    setrow2(db,data);
                }


            }
            
            let started = false;
            let player_picked1 = $('.game-board .picked .name').text();
            if(player_picked1){
                started = true;
            }
            $('.game-board .card').click(function(){
                if(!started){
                    localStorage.removeItem('player_picked');

                    $('.start-game100').remove();
                    
                    if(!player_picked){
                        $('.game-board .card').removeClass('picked');
                        $(this).addClass('picked');
                        let player_picked2 = $('.game-board .picked .name').text();
                        localStorage.setItem('player_picked',player_picked2);

                        let game_win_score = winning_score;
                        localStorage.setItem('game_win_score',game_win_score);

                    }

                    start_game();

                    started = true;
                }
               
            });

            $('.start-game').click(function(){
                
                clearInterval(clock_interval);
                clearInterval(game_clock_interval);
                $('.start-game').text('14');
                $('.countdown').text('20:00');
                    
                localStorage.removeItem('q1t1');
                localStorage.removeItem('q1t2');
                localStorage.removeItem('q2t1');
                localStorage.removeItem('q2t2');
                localStorage.removeItem('q3t1');
                localStorage.removeItem('q3t2');
                localStorage.removeItem('q4t1');
                localStorage.removeItem('q4t2');

                resumed = true;
                game_over = false;
                $('.game-clock').text('20:00');
                localStorage.removeItem('game_clock');

                $('.rematch-game').hide();
                started = false;
                $('.alert-winner').hide()
                $('.score').text(0)
                player_picked = false;
                $('.start-game100').remove();
                $('.resume-game').hide();
                $('.picked').removeClass('picked');
                if(!started){
                    $('.games-table td').text('-');
                    $('.start-game').text('Select A Player');
                    playRound();
                }
            });
            $('.start-game21').click(function(){
                winning_score = 21;
            });
            $('.start-game100').click(function(){
                winning_score = 100;
            });
            $('.auto-game').click(function(){
                //playRound();
                $('.auto-game').hide();
                auto_game = true;
                auto_game_start();
            });

            $('body').on('click', '.new-game', function(){
                started = false;
                $('.games-table td').text('-');
                $('.alert-winner').hide();
                $('.picked').removeClass('picked');
                $('.game-board .score').text('0');
                $('.new-game').removeClass('new-game');
                $('.start-game').text('Select A Player');
                playRound();
            });
            $('body').on('click', '.rematch-game', function(){
                started = false;
                player_picked = false;
                $('.start-game100').hide();
                $('.alert-winner').hide();
                $('.rematch-game').hide();
                $('.picked').removeClass('picked');
                $('.game-board .score').text('0');
                $('.new-game').removeClass('new-game');
                $('.start-game').text('Select A Player');
                
                let player1_name = $('.player1').text();
                let player2_name = $('.player2').text();
            
                $('.game-table td').text('');
                $('.game-table tr:eq(0) td:eq(0)').text(player1_name);
                $('.game-table tr:eq(1) td:eq(0)').text(player2_name);
                
            
            });

            $('body').on('click', '.resume-game', function(){
                resumed = true;
                $('.start-game100').remove();
                $('.resume-game').hide();
                start_game();
            });

            $('.score').dblclick(function(){
                $('.score').toggleClass('score-bigfont');
                $('body').toggleClass('bigfont');
            });

            $('.countdown').dblclick(function(){
                resumed = true;
                $('video').toggleClass('show-video');
                //$('body').toggleClass('bigfont');
            });

            setInterval(function(){
                $('body').trigger('click');
            },60000); 



        });

    </script>

<style>
    .container {
        margin-top: 20px;
        text-align: center;
    }
    nav .dropdown-menu.show{
        margin-left: 0px !important;
    }
    .game-board .card-body {
        text-align: center;
        position: relative;
    }
    .game-board .card{
        margin: 0 5px;
    }
    .game-board h5.card-title {
        font-size: 60px;
        margin-top: 20px;
    }
    .card .name {
        font-size: 30px;
        text-align: left;
        
    }
    .playing{
        border-bottom: 30px solid orange;
    }
    .scored {
        position: absolute;
        top: 2px;
        right: 10px;
        font-size: 30px;
    }
    .foul{
        border-bottom: 30px solid #dc3545;
    }
    .card.picked {
        border: 3px solid #28a745;
    }
    .alert-winner {
        margin: 0px 20px 20px 20px;
        display: none;
    }
    .start-game {
        margin-bottom: 20px;
        font-size: 40px;
    }
    .rematch-game{
        display: none;
        margin-bottom: 20px;
        font-size: 40px;
    }
    .auto-game{
        margin-bottom: 20px;
    }
    .resume-game {
        margin-bottom: 20px;
        font-size: 40px;
    }
    .game-clock {
        margin-bottom: 20px;
        font-size:40px;
    }
    .score-bigfont {
        font-size: 300px !important;
        position: absolute;
        left: -140px;
        top: 0px;
        color: white;
        margin-left: -20px;
    }
    .bigfont .scored {
        font-size: 60px;
        color: #28a745;
    }
    .bigfont .playing {
        border-bottom-width: 50px;
    }
    h5.card-title.score.score2.score-bigfont {
        margin-left: 60px;
    }
    h5.card-title.score.score2.score-bigfont:before {
        content: '-';
        font-size: 68px;
        position: relative;
        top: -85px;
    }
    video {
        display: none;
        width: 100%;
        margin-top: 80px;
    }
    .show-video{
        display: block;
    }

    .games-table {
        margin-top: 20px;
        margin-left: 35%;
        font-size: 20px;
        max-width: 80%;
    }
    td.name{
        width:150px;
    }
    td{
        float: left;
    }
    .sitename{
        font-size:40px;
        margin-left: 33%;
        color: white;
        background: black;
        padding: 10px;
        border-radius: 10px;
        display: inline;
        
    }
    .basketballgame{
        font-size:35px;
    }
    @media (max-width: 420px) {
        h5.card-title.score.score1.score-bigfont {
            left: 0px;
        }
        h5.card-title.score.score2.score-bigfont {
            left: -200px;
            margin-left: 5px;
            top: 250px;
        }
        h5.card-title.score.score2.score-bigfont:before {
            content: '';
        }
        
    }
    @media (max-width: 520px) {
        .games-table {

        margin-left: 20px;

    }
    .sitename{
        font-size: 20px;
        margin-left: 20px;
    }
    nav h2{
        margin-top: 10px;
        
    }
    nav .my-2 {
        width: 100%;
        text-align: center;
    }
    .basketballgame{
        font-size:20px
    }
    .start-game, .rematch,.resume-game, .game-clock,.card .name{
        font-size: 20px;
    }
    }
</style>
</head>
<body class="">
    <nav class="navbar navbar-light bg-light">
        <h2>
            <a class="navbar-brand" href="index.html">Sneaker Rush</a>
            
            <button type="button" class="btn btn-danger boombox-button" id="play">
              <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-boombox-fill" viewBox="0 0 16 16">
                <path d="M14 0a.5.5 0 0 1 .5.5V2h.5a1 1 0 0 1 1 1v2H0V3a1 1 0 0 1 1-1h12.5V.5A.5.5 0 0 1 14 0M2 3.5a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0m2 0a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0m7.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1m1.5-.5a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0M9.5 3h-3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1M6 10.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m-1.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1m7 1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m.5-1.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0"/>
                <path d="M0 6h16v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1zm2 4.5a2.5 2.5 0 1 0 5 0 2.5 2.5 0 0 0-5 0m7 0a2.5 2.5 0 1 0 5 0 2.5 2.5 0 0 0-5 0"/>
              </svg>
            </button>
        </h2>
        
        <div class=" my-2 my-lg-0">
            <div class="dropdown">
                <button class="btn btn-primary dropdown-toggle basketballgame" type="button" id="links" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Basketball Game
                </button>
                <div class="dropdown-menu" aria-labelledby="links">
                  <a class="dropdown-item" href="index.html">Home</a>
                  <a class="dropdown-item" href="login.html">Login / Sign Up</a>
                  <a class="dropdown-item" href="signout.html">Sign Out</a>
                  <hr class="nav-hr">
                  <a class="dropdown-item" href="war.html">War</a>
                  <a class="dropdown-item" href="guess.html">Guess</a>
                  <a class="dropdown-item" href="entry.html">Entry</a>
                  <a class="dropdown-item" href="store.html">Store</a>
                  <a class="dropdown-item" href="game.html">Game</a>
                  <a class="dropdown-item" href="livegame.html">Live Game</a>
                </div>
              </div>
            <!-- <a href="index.html"><button class="btn btn-primary my-2 my-sm-0">War</button></a> -->
        </div>

        <div class="points">
            <h4>Points: <span class="point-amount">0</span></h4>
        </div>

    </nav>

    <div class="container">

        <button class="btn btn-primary game-clock countdown">20:00</button>
        <button class="btn btn-primary start-game start-game21">Start Game</button>
        <!-- <button class="btn btn-primary auto-game">Auto Game</button> -->
        <!-- <button class="btn btn-primary start-game start-game100">Start Game 100</button> -->

        <button class="btn btn-primary resume-game">Resume Game</button>
        <button class="btn btn-primary rematch-game">Rematch Game</button>

        <div class="alert alert-primary alert-winner" role="alert">
            Sneaker 1 is the winner!
        </div>


        <div class="game-board d-flex justify-content-center">
            <div class="card player1">
                <h5 class="card-header name">Sneaker 1</h5>
                <div class="card-body">

                <div class="card-title scored score1-scored"></div>
                <h5 class="card-title score score1">0</h5>
                </div>
            </div>
            <div class="card player2">
                <h5 class="card-header name">Sneaker 2</h5>
                <div class="card-body">

                <div class="card-title scored score2-scored"></div>
                <h5 class="card-title score score2">0</h5>
                </div>
            </div>
        </div>
    </div>

    <table class="table table-dark games-table">
        <tbody>
            <tr class="team1">
                <td class="name">Sneakers 1</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
            </tr>
            <tr class="team2">
                <td class="name">Sneakers 2</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
            </tr> 
        </tbody>
      </table>
<h1 class="sitename">SneakerRushApp.com</h1>
    <video src="loop.mp4" loop controls mute></video>


      <script type="text/javascript">
      
      
      </script>
    
</body>
</html>
